import{a as n,b as a,o as s,q as U,s as N,v as P,j as v,w as R,x as K,y as Q,d as C,z as T,A as q,l as p,B as L,e as k,g as x,f as B,t as w,C as A,D as Z,F as $,r as V,E as O,G,i as S,I as H,c as J}from"./index-BRhRzTsO.js";import{_ as W,a as X}from"./ItemsSkeleton.vue_vue_type_script_setup_true_lang-Cl1nJeze.js";function Y(e,i){return s(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"})])}function _(e,i){return s(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"})])}function ee(e,i){return s(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"})])}const ze=({query:e})=>i=>U(`list/${i}`,()=>{const r=N(),u=P(),t=v(!1),o=v(""),f=v(1),c=v([]),d=v([]),l=v(0),h=v([]),b=v({});async function F(){z(),t.value=!0,f.value=1;try{const{items:m,filters:g}=await e({search:o.value,filters:b.value});c.value=m,l.value=c.value.length,d.value=c.value.slice((f.value-1)*20,f.value*20),h.value=g??[]}catch(m){console.error(m instanceof Error?m.message:"An unknown error occurred")}finally{t.value=!1}}async function I(){f.value+=1,d.value.push(...c.value.slice((f.value-1)*20,f.value*20))}function E(m){z(),o.value=m,F(),j()}function M({prop:m,value:g}){g.length===0?delete b.value[m]:b.value[m]=g,j()}function D(){b.value={},j()}function z(){d.value=[],c.value=[],l.value=0}function j(){const m={};o.value.length&&(m.q=o.value),Object.entries(b.value).forEach(([g,y])=>{y.length&&(m[g]=y)}),u.push({query:m})}return R(()=>{b.value={},o.value="";const m=typeof r.query.q=="string"?r.query.q:"";o.value=m,Object.entries(r.query).forEach(([g,y])=>{g!=="q"&&y&&(typeof y=="string"?b.value[g]=y.includes(",")?y.split(","):[y]:Array.isArray(y)&&(b.value[g]=y))}),F()}),K(()=>{Q()?._s?.forEach(m=>{m.$id===`list/${i}`&&(m.$dispose(),E(""))}),u.push({query:{}})}),{items:d,itemsCount:l,search:o,loading:t,filters:h,filtersValues:b,fetch:F,loadMore:I,setSearch:E,setFilters:M,removeFilters:D}}),te={class:"relative"},se={class:"absolute left-0 flex items-center h-full px-2"},le={class:"absolute right-0 flex items-center h-full gap-2 px-3"},ne={key:0,class:"px-2 text-sm text-white rounded-md bg-black-200 hidden sm:block"},oe={class:"font-semibold"},ae={key:1,class:"w-20 h-6 px-2 rounded-md bg-black-200 animate-pulse"},re={key:0,class:"absolute top-1 right-1 bg-[#ff5e65] size-2 rounded-full"},ie={key:0,class:"flex gap-2 overflow-x-auto pb-0.5"},ue={class:""},de={class:"flex items-center gap-1 flex-wrap"},ce=["onClick"],fe=C({__name:"SearchBar",props:{query:{},total:{},scrolledDown:{type:Boolean},hasFilters:{type:Boolean},hasSelectedFilters:{type:Boolean},loading:{type:Boolean},filters:{},filtersValues:{}},emits:["input","open-filters","remove-filter"],setup(e){const i=e,r=v(i.query||"");return T(()=>i.query,u=>{r.value=u}),(u,t)=>(s(),n("div",{class:q(["sticky top-0 left-0 right-0 px-5 pt-3 pb-2 duration-300 z-10 gap-2 flex flex-col",[e.scrolledDown?"bg-black-300 shadow-lg":"bg-transparent"]])},[a("div",te,[a("div",se,[k(x(ee),{class:"w-6 h-6 text-black-200"})]),a("div",le,[e.loading?(s(),n("div",ae)):(s(),n("p",ne,[t[3]||(t[3]=B(" total ",-1)),a("span",oe,w(e.total),1)])),t[4]||(t[4]=a("div",{class:"w-0.5 h-[calc(100%-20px)] rounded-full bg-black-200/20"},null,-1)),e.hasFilters?(s(),n("button",{key:2,type:"button",class:"p-1 rounded-md hover:bg-black-200 relative",onClick:t[0]||(t[0]=o=>u.$emit("open-filters"))},[k(x(_),{class:"w-6 h-6 text-black-100"}),e.hasSelectedFilters?(s(),n("div",re)):p("",!0)])):p("",!0)]),L(a("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>r.value=o),class:"w-full h-full py-4 pl-12 pr-36 sm:pr-60 text-white border-0 rounded-md outline-none bg-black-300 focus:outline-none sm:text-sm focus:ring-2 focus:ring-[#ff5e65] focus:border-transparent",type:"text",placeholder:"Search...",onKeyup:t[2]||(t[2]=Z(o=>u.$emit("input",r.value),["enter"]))},null,544),[[A,r.value]])]),e.hasSelectedFilters?(s(),n("div",ie,[(s(!0),n($,null,V(e.filtersValues,(o,f)=>(s(),n("div",{key:f,class:"flex items-center gap-1 text-sm p-1 flex-shrink-0 text-white rounded-md bg-black-300"},[a("div",ue,w(e.filters.find(c=>c.prop===f)?.name||f),1),a("div",de,[(s(!0),n($,null,V(o,c=>(s(),n("button",{key:c,type:"button",class:"text-white bg-black-200 px-1 rounded-md flex items-center gap-1",onClick:d=>u.$emit("remove-filter",{prop:f,value:c})},[k(x(O),{class:"size-4 text-white"}),B(" "+w(e.filters.find(d=>d.prop===f)?.options.find(d=>d.id===c)?.name||c),1)],8,ce))),128))])]))),128))])):p("",!0)],2))}}),me={class:"flex flex-col"},ve=["src","alt"],he={key:0,class:"absolute inset-0 bg-black-300 rounded-md animate-pulse"},pe={key:1,class:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-20 rounded-md"},be=["src"],ge=["title"],ye=C({__name:"ItemVideo",props:{name:{},video:{},thumbnail:{}},emits:["show"],setup(e){const i=v(!1),r=v(!1);function u(){i.value=!0}return(t,o)=>(s(),n("div",me,[i.value?p("",!0):(s(),n("div",{key:0,class:"relative w-full aspect-video rounded-md cursor-pointer bg-gray-800",onClick:u},[a("img",{src:e.thumbnail,alt:e.name,class:"w-full h-full object-cover rounded-md",loading:"lazy",onLoad:o[0]||(o[0]=f=>r.value=!0),onError:o[1]||(o[1]=f=>r.value=!0)},null,40,ve),r.value?p("",!0):(s(),n("div",he)),r.value?(s(),n("div",pe,[...o[2]||(o[2]=[a("div",{class:"w-16 h-16 bg-white bg-opacity-90 rounded-full flex items-center justify-center hover:bg-opacity-100 transition-all"},[a("svg",{class:"w-8 h-8 text-black ml-1",fill:"currentColor",viewBox:"0 0 24 24"},[a("path",{d:"M8 5v14l11-7z"})])],-1)])])):p("",!0)])),i.value?(s(),n("video",{key:1,class:"object-cover w-full h-full rounded-md",src:e.video,autoplay:"",muted:"",playsinline:"",controls:""},null,8,be)):p("",!0),a("div",null,[a("p",{class:"text-sm truncate px-0.5 mt-1.5 text-white",title:e.name},w(e.name),9,ge)])]))}}),ke={class:"relative flex-1 w-full"},xe={key:3,class:"py-10"},Ae=C({__name:"ItemsList",props:{items:{},itemsCount:{},loading:{type:Boolean},search:{},hasFilters:{type:Boolean,default:!1},hasSelectedFilters:{type:Boolean,default:!1},filters:{},filtersValues:{},isVideo:{type:Boolean,default:!1},hasSearch:{type:Boolean,default:!0}},emits:["set-query","select","load-more","open-filters","remove-filter"],setup(e,{emit:i}){const r=i,u=v(null),{y:t}=G(u),o=v(!1);function f(c){o.value=c,c===!0&&r("load-more")}return(c,d)=>(s(),n("div",ke,[e.hasSearch?(s(),S(fe,{key:0,query:e.search,"scrolled-down":x(t)>40,total:e.itemsCount,loading:e.loading,"has-filters":e.hasFilters,"has-selected-filters":e.hasSelectedFilters,filters:e.filters,"filters-values":e.filtersValues,onInput:d[0]||(d[0]=l=>c.$emit("set-query",l)),onOpenFilters:d[1]||(d[1]=l=>c.$emit("open-filters")),onRemoveFilter:d[2]||(d[2]=l=>c.$emit("remove-filter",l))},null,8,["query","scrolled-down","total","loading","has-filters","has-selected-filters","filters","filters-values"])):p("",!0),a("div",{ref_key:"el",ref:u,class:q(["grid w-full gap-3 p-4 px-5 pb-32 mx-auto overflow-y-scroll h-[calc(100vh-69px)]",{"grid-cols-1 lg:grid-cols-2":e.isVideo,"items-grid-small md:items-grid":!e.isVideo}])},[e.isVideo?(s(!0),n($,{key:1},V(e.items,l=>(s(),S(ye,{key:l.id,name:l.name,video:l.video,thumbnail:l.thumbnail},null,8,["name","video","thumbnail"]))),128)):(s(!0),n($,{key:0},V(e.items,l=>(s(),S(W,{id:l.id,key:l.id,name:l.name,image:l.image,souvenir:l?.souvenir??!1,stattrak:l?.stattrak??!1,rare:l?.rare??!1,genuine:l?.genuine??!1,"market-hash-name":l.market_hash_name,onShow:h=>c.$emit("select",l.id)},null,8,["id","name","image","souvenir","stattrak","rare","genuine","market-hash-name","onShow"]))),128)),e.loading?(s(),S(X,{key:2})):p("",!0),e.loading?p("",!0):L((s(),n("div",xe,null,512)),[[x(H),f]])],2)]))}}),we=["value","checked","onChange"],$e=C({__name:"MultiSelectFilter",props:{options:{},values:{}},emits:["update:values"],setup(e,{emit:i}){const r=e,u=i,t=v(""),o=J(()=>r.options.filter(d=>d.name.toLocaleLowerCase().includes(t.value.toLocaleLowerCase()))),f=d=>{const l=r.values,h=l.indexOf(d);h===-1?l.push(d):l.splice(h,1),u("update:values",l)},c=d=>r.values.includes(d);return(d,l)=>(s(),n("div",null,[L(a("input",{"onUpdate:modelValue":l[0]||(l[0]=h=>t.value=h),class:"w-full h-full py-3 text-white rounded-md outline-none bg-black-300 border-2 border-black-300 focus:outline-none mb-4 sm:text-sm focus:ring-2 focus:ring-[#ff5e65] focus:border-transparent",type:"text",placeholder:"Search to filter..."},null,512),[[A,t.value]]),(s(!0),n($,null,V(o.value,h=>(s(),n("label",{key:h.id,class:"flex items-center gap-2 p-2 text-gray-300 rounded-md cursor-pointer hover:bg-black-300"},[a("input",{type:"checkbox",class:"w-4 h-4 text-[#ff5e65] border-gray-300 rounded focus:ring-[#ff5e65]",value:h.id,checked:c(h.id),onChange:b=>f(h.id)},null,40,we),B(" "+w(h.name),1)]))),128))]))}}),Ve={key:0},Ce=C({__name:"FiltersPanelControl",props:{prop:{},name:{},type:{},options:{},values:{}},emits:["close","update:values"],setup(e){return(i,r)=>e.type==="multi-select"?(s(),n("div",Ve,[k($e,{options:e.options,values:e.values,"onUpdate:values":r[0]||(r[0]=u=>i.$emit("update:values",{prop:e.prop,value:u}))},null,8,["options","values"])])):p("",!0)}}),Se={class:"h-dvh md:border-l-2 border-black-300 md:w-80 flex-shrink-0 xl:w-[30rem] flex flex-col absolute inset-0 md:relative bg-black-400 z-50"},qe={class:"flex items-center w-full h-[69px] border-b-2 border-black-300 px-4 sticky top-0 text-black-100"},Be={class:"h-[calc(100vh-69px)] py-4 pt-0 overflow-x-hidden"},Fe=["onClick"],je={class:"text-sm font-normal text-black-100"},Oe=C({__name:"FiltersPanel",props:{filters:{},filtersValues:{}},emits:["close","set-filters","remove-filters"],setup(e){const i=v({});return(r,u)=>(s(),n("div",Se,[a("div",qe,[a("button",{class:"ml-auto disabled:cursor-wait",onClick:u[0]||(u[0]=t=>r.$emit("close"))},[k(x(O),{class:"w-6 h-6 text-white"})])]),a("div",Be,[Object.keys(e.filtersValues).length>0?(s(),n("button",{key:0,type:"button",class:"w-full py-2 mb-2 font-semibold text-red-800 border-y-2 border-red-800/20 bg-red-900/20 hover:bg-red-900/30",onClick:u[1]||(u[1]=t=>r.$emit("remove-filters"))}," Remove all selected filters ")):p("",!0),a("div",null,[(s(!0),n($,null,V(e.filters,t=>(s(),n("div",{key:t.prop},[a("button",{class:"sticky top-0 flex items-center justify-between w-full p-4 font-semibold text-gray-100 border-b-2 border-black-300 bg-black-400",onClick:o=>i.value[t.prop]=!i.value[t.prop]},[a("div",null,[B(w(t.name)+" ",1),a("span",je,"("+w(e.filtersValues[t.prop]?.length?`${e.filtersValues[t.prop].length}/${t.options.length}`:t.options.length)+")",1)]),k(x(Y),{class:q(["w-6 h-6 duration-300 text-black-200",{"rotate-180":i.value[t.prop]}])},null,8,["class"])],8,Fe),i.value[t.prop]?(s(),n("div",{key:0,class:q(["p-4",{"border-b-2 border-black-300":i.value}])},[k(Ce,{prop:t.prop,name:t.name,type:t.type,options:t.options,values:e.filtersValues[t.prop]??[],"onUpdate:values":u[2]||(u[2]=o=>r.$emit("set-filters",o))},null,8,["prop","name","type","options","values"])],2)):p("",!0)]))),128))])])]))}});export{Ae as _,Oe as a,ze as c};
