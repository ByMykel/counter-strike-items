import{o as f,c as _,a as m,n as T,r as p,b as B,d as N,u as X,t as I,i as oe,w as se,e as ne,f as le,g as L,h as Q,F as Y,j as G,k as $,l as re,m as C,p as J,v as ae,q as V,s as ce,x as K,y as q,B as ie,z as ue,A as j,C as de}from"./index-1145d7db.js";function fe(n,s){return f(),_("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[m("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})])}function me(n){var s;const t=I(n);return(s=t==null?void 0:t.$el)!=null?s:t}const Z=oe?window:void 0;function O(...n){let s,t,o,e;if(typeof n[0]=="string"||Array.isArray(n[0])?([t,o,e]=n,s=Z):[s,t,o,e]=n,!s)return T;Array.isArray(t)||(t=[t]),Array.isArray(o)||(o=[o]);const r=[],h=()=>{r.forEach(u=>u()),r.length=0},d=(u,b,w,x)=>(u.addEventListener(b,w,x),()=>u.removeEventListener(b,w,x)),v=se(()=>[me(s),I(e)],([u,b])=>{h(),u&&r.push(...t.flatMap(w=>o.map(x=>d(u,w,x,b))))},{immediate:!0,flush:"post"}),c=()=>{v(),h()};return ne(c),c}const W=1;function pe(n,s={}){const{throttle:t=0,idle:o=200,onStop:e=T,onScroll:r=T,offset:h={left:0,right:0,top:0,bottom:0},eventListenerOptions:d={capture:!1,passive:!0},behavior:v="auto",window:c=Z}=s,u=p(0),b=p(0),w=B({get(){return u.value},set(l){a(l,void 0)}}),x=B({get(){return b.value},set(l){a(void 0,l)}});function a(l,g){var D,A,S;if(!c)return;const P=I(n);P&&((S=P instanceof Document?c.document.body:P)==null||S.scrollTo({top:(D=I(g))!=null?D:x.value,left:(A=I(l))!=null?A:w.value,behavior:I(v)}))}const E=p(!1),i=N({left:!0,right:!1,top:!0,bottom:!1}),y=N({left:!1,right:!1,top:!1,bottom:!1}),M=l=>{E.value&&(E.value=!1,y.left=!1,y.right=!1,y.top=!1,y.bottom=!1,e(l))},te=X(M,t+o),R=l=>{if(!c)return;const g=l===c?l.document.documentElement:l===c.document?l.documentElement:l,{display:D,flexDirection:A}=getComputedStyle(g),S=g.scrollLeft;y.left=S<u.value,y.right=S>u.value;const P=Math.abs(S)<=0+(h.left||0),U=Math.abs(S)+g.clientWidth>=g.scrollWidth-(h.right||0)-W;D==="flex"&&A==="row-reverse"?(i.left=U,i.right=P):(i.left=P,i.right=U),u.value=S;let k=g.scrollTop;l===c.document&&!k&&(k=c.document.body.scrollTop),y.top=k<b.value,y.bottom=k>b.value;const z=Math.abs(k)<=0+(h.top||0),F=Math.abs(k)+g.clientHeight>=g.scrollHeight-(h.bottom||0)-W;D==="flex"&&A==="column-reverse"?(i.top=F,i.bottom=z):(i.top=z,i.bottom=F),b.value=k},H=l=>{if(!c)return;const g=l.target===c.document?l.target.documentElement:l.target;R(g),E.value=!0,te(l),r(l)};return O(n,"scroll",t?le(H,t,!0,!1):H,d),O(n,"scrollend",M,d),{x:w,y:x,isScrolling:E,arrivedState:i,directions:y,measure(){const l=I(n);c&&l&&R(l)}}}const he=m("div",{class:"block relative rounded-md p-0.5 border-transparent animate-pulse overflow-hidden border-2 min-h-[10rem] bg-black-300 focus:border-blue-500 hover:border-blue-500 outline-none h-full cursor-pointer"},null,-1),ve=m("div",{class:"bg-black-300 rounded-md h-[1.7rem] mt-1.5 animate-pulse"},null,-1),be=[he,ve],ge=L({__name:"ItemsSkeleton",props:{numberItems:{default:30}},setup(n){return(s,t)=>(f(!0),_(Y,null,Q(s.numberItems,o=>(f(),_("div",{key:`skeleton-${o}`,class:"flex flex-col"},be))),128))}}),_e={class:"relative"},ye={class:"absolute left-0 flex items-center h-full px-2"},we={class:"absolute right-0 flex items-center h-full px-3"},xe={key:0,class:"px-2 text-sm text-white rounded-md bg-black-200"},Se={class:"font-semibold"},ke={key:1,class:"w-20 h-6 px-2 rounded-md bg-black-200 animate-pulse"},$e=L({__name:"SearchBar",props:{query:{},total:{},scrolledDown:{type:Boolean}},emits:["input"],setup(n){const t=p(n.query||"");return(o,e)=>(f(),_("div",{class:V(["sticky top-0 left-0 right-0 z-50 px-5 pt-3 pb-2 duration-300",[o.scrolledDown?"bg-black-300 shadow-lg":"bg-transparent"]])},[m("div",_e,[m("div",ye,[G($(fe),{class:"w-6 h-6 text-black-200"})]),m("div",we,[o.total?(f(),_("p",xe,[re(" total "),m("span",Se,C(o.total),1)])):(f(),_("div",ke))]),J(m("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>t.value=r),class:V(["w-full h-full py-4 pl-12 text-white rounded-md bg-black-300 focus:outline-none sm:text-sm",{"focus:ring-2 focus:ring-blue-500 focus:border-blue-500":!o.scrolledDown}]),type:"text",placeholder:"Search...",onInput:e[1]||(e[1]=r=>o.$emit("input",t.value))},null,34),[[ae,t.value]])])],2))}}),Ie="https://corsproxy.io/?",Ee=Ie+"https://prices.csgotrader.app/latest/prices_v6.json";class Pe{async fetchPrices(){return(await ce.get(Ee)).data}}const ee=K("prices",()=>{const n=new Pe,s=p({});async function t(){try{s.value=await n.fetchPrices()}catch{console.error("Unable to load prices")}}function o(e){return s.value[e]}return{prices:s,fetchPrices:t,getPrice:o}}),De={class:"flex flex-col"},Ae={class:"relative block h-[12rem] p-1 overflow-hidden border-2 border-transparent rounded-md outline-none cursor-pointer focus:border-blue-500 hover:border-blue-500"},Le={key:0,class:"absolute z-10 flex gap-1 text-sm font-semibold text-white top-2 left-2"},Te=["src","alt"],Be=["title"],Ce=L({__name:"ItemCard",props:{id:{},name:{},image:{}},setup(n){const s=n,{getPrice:t}=ee(),o=B(()=>{const e=t(s.name);return(e==null?void 0:e.steam.last_7d)||(e==null?void 0:e.steam.last_24h)||(e==null?void 0:e.steam.last_30d)||(e==null?void 0:e.steam.last_90d)||null});return(e,r)=>(f(),_("div",De,[m("div",Ae,[o.value?(f(),_("div",Le," $ "+C(o.value),1)):q("",!0),m("img",{class:V(["object-contain w-full h-full py-4 rounded-md bg-black-300/80 bg-[url('/img/graph-paper.svg')]",{"pb-0":e.id.includes("agent-")}]),src:e.image,alt:e.name},null,10,Te)]),m("div",null,[m("p",{class:"text-sm truncate px-0.5 mt-1.5 text-white",title:e.name},C(e.name),9,Be)])]))}}),Ve=K("all-items",()=>{const n=new ie,s=p([]),t=p(),o=p(!1),e=p();async function r(d){o.value=!0;try{const v=await n.getItems(d);s.value=v.data,e.value=v.page.next,t.value=v.total}catch(v){console.error(v)}finally{o.value=!1}}async function h(){if(e.value!=null){o.value=!0;try{const d=await n.getNext(e.value);s.value.push(...d.data),e.value=d.page.next}catch(d){console.error(d)}finally{o.value=!1}}}return{items:s,loading:o,total:t,fetchItems:r,loadMore:h}}),qe={class:"relative flex-1 w-full"},Me={key:1,class:"py-10"},He=L({__name:"HomeView",setup(n){const s=ue(),t=Ve(),o=p(null),{y:e}=pe(o),r=p(u("q")),h=p(!1),{fetchPrices:d}=ee();d();const v=X(()=>{t.fetchItems(r.value)},400);function c(a){r.value=a,b(),v()}function u(a){return new URLSearchParams(window.location.search).get(a)||""}function b(){const a=new URL(window.location.href);r.value?a.searchParams.set("q",r.value):a.searchParams.delete("q"),history.pushState({},"",a.toString())}function w(a){h.value=a,a===!0&&t.loadMore()}async function x(a){s.getItemDetails(a)}return t.fetchItems(r.value),(a,E)=>(f(),_("div",qe,[G($e,{query:r.value,"scrolled-down":$(e)>40,total:$(t).total,onInput:c},null,8,["query","scrolled-down","total"]),m("div",{ref_key:"el",ref:o,class:"grid w-full gap-3 p-4 px-5 pb-32 mx-auto overflow-y-scroll h-dvh items-grid-small md:items-grid"},[(f(!0),_(Y,null,Q($(t).items,i=>(f(),j(Ce,{id:i.id,key:i.id,name:i.name,image:i.image,onClick:y=>x(i.id)},null,8,["id","name","image","onClick"]))),128)),$(t).loading?(f(),j(ge,{key:0})):q("",!0),$(t).loading?q("",!0):J((f(),_("div",Me,null,512)),[[$(de),w]])],512)]))}});export{He as default};
