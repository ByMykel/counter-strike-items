import{a as n,b as r,o as s,q as N,s as P,v as R,j as p,w as K,x as Q,y as T,d as C,z as Z,A as F,l as g,B as L,e as k,g as x,f as S,t as w,C as O,D as G,F as $,r as V,E as z,G as H,i as q,I as J,c as W}from"./index-KuBLwD_h.js";import{_ as X,a as Y}from"./ItemsSkeleton.vue_vue_type_script_setup_true_lang-BhXoR3Uk.js";function _(e,i){return s(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"})])}function ee(e,i){return s(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"})])}function te(e,i){return s(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"})])}const ze=({query:e})=>i=>N(`list/${i}`,()=>{const o=P(),u=R(),t=p(!1),a=p(""),m=p(1),c=p([]),d=p([]),l=p(0),b=p([]),y=p({});async function B(){E(),t.value=!0,m.value=1;try{const{items:f,filters:h}=await e({search:a.value,filters:y.value});c.value=f,l.value=c.value.length,d.value=c.value.slice((m.value-1)*20,m.value*20),b.value=h??[]}catch(f){console.error(f instanceof Error?f.message:"An unknown error occurred")}finally{t.value=!1}}async function I(){m.value+=1,d.value.push(...c.value.slice((m.value-1)*20,m.value*20))}function A(f){E(),a.value=f,B(),j()}function M({prop:f,value:h}){h.length===0?delete y.value[f]:y.value[f]=h,j()}function D(){y.value={},j()}function E(){d.value=[],c.value=[],l.value=0}function j(){const f={};Object.entries(o.query).forEach(([h,v])=>{v!=null&&(Array.isArray(v)?f[h]=v.filter(U=>U!==null):typeof v=="string"&&(f[h]=v))}),a.value.length?f.q=a.value:delete f.q,Object.entries(y.value).forEach(([h,v])=>{v.length?f[h]=v:delete f[h]}),u.push({query:f})}return K(()=>{y.value={},a.value="";const f=typeof o.query.q=="string"?o.query.q:"";a.value=f,Object.entries(o.query).forEach(([h,v])=>{h!=="q"&&h!=="itemId"&&v&&(typeof v=="string"?y.value[h]=v.includes(",")?v.split(","):[v]:Array.isArray(v)&&(y.value[h]=v))}),B()}),Q(()=>{T()?._s?.forEach(f=>{f.$id===`list/${i}`&&(f.$dispose(),A(""))}),u.push({query:{}})}),{items:d,itemsCount:l,search:a,loading:t,filters:b,filtersValues:y,fetch:B,loadMore:I,setSearch:A,setFilters:M,removeFilters:D}}),se={class:"relative"},le={class:"absolute left-0 flex items-center h-full px-2"},ne={class:"absolute right-0 flex items-center h-full gap-2 px-3"},oe={key:0,class:"px-2 text-sm text-white rounded-md bg-black-200 hidden sm:block"},ae={class:"font-semibold"},re={key:1,class:"w-20 h-6 px-2 rounded-md bg-black-200 animate-pulse"},ie={key:2,class:"w-0.5 h-[calc(100%-20px)] rounded-full bg-black-200/20"},ue={key:0,class:"absolute top-1 right-1 bg-[#ff5e65] size-2 rounded-full"},de={key:0,class:"flex gap-2 overflow-x-auto pb-0.5"},ce={class:""},fe={class:"flex items-center gap-1 flex-wrap"},me=["onClick"],ve=C({__name:"SearchBar",props:{query:{},total:{},scrolledDown:{type:Boolean},hasFilters:{type:Boolean},hasSelectedFilters:{type:Boolean},loading:{type:Boolean},filters:{},filtersValues:{}},emits:["input","open-filters","remove-filter"],setup(e){const i=e,o=p(i.query||"");return Z(()=>i.query,u=>{o.value=u}),(u,t)=>(s(),n("div",{class:F(["sticky top-0 left-0 right-0 px-5 pt-3 pb-2 duration-300 z-10 gap-2 flex flex-col",[e.scrolledDown?"bg-black-300 shadow-lg":"bg-transparent"]])},[r("div",se,[r("div",le,[k(x(te),{class:"w-6 h-6 text-black-200"})]),r("div",ne,[e.loading?(s(),n("div",re)):(s(),n("p",oe,[t[3]||(t[3]=S(" total ",-1)),r("span",ae,w(e.total),1)])),e.hasFilters?(s(),n("div",ie)):g("",!0),e.hasFilters?(s(),n("button",{key:3,type:"button",class:"p-1 rounded-md hover:bg-black-200 relative",onClick:t[0]||(t[0]=a=>u.$emit("open-filters"))},[k(x(ee),{class:"w-6 h-6 text-black-100"}),e.hasSelectedFilters?(s(),n("div",ue)):g("",!0)])):g("",!0)]),L(r("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>o.value=a),class:"w-full h-full py-4 pl-12 pr-36 sm:pr-60 text-white border-0 rounded-md outline-none bg-black-300 focus:outline-none sm:text-sm focus:ring-2 focus:ring-[#ff5e65] focus:border-transparent",type:"text",placeholder:"Search...",onKeyup:t[2]||(t[2]=G(a=>u.$emit("input",o.value),["enter"]))},null,544),[[O,o.value]])]),e.hasSelectedFilters?(s(),n("div",de,[(s(!0),n($,null,V(e.filtersValues,(a,m)=>(s(),n("div",{key:m,class:"flex items-center gap-1 text-sm p-1 flex-shrink-0 text-white rounded-md bg-black-300"},[r("div",ce,w(e.filters.find(c=>c.prop===m)?.name||m),1),r("div",fe,[(s(!0),n($,null,V(a,c=>(s(),n("button",{key:c,type:"button",class:"text-white bg-black-200 px-1 rounded-md flex items-center gap-1",onClick:d=>u.$emit("remove-filter",{prop:m,value:c})},[k(x(z),{class:"size-4 text-white"}),S(" "+w(e.filters.find(d=>d.prop===m)?.options.find(d=>d.id===c)?.name||c),1)],8,me))),128))])]))),128))])):g("",!0)],2))}}),he={class:"flex flex-col"},pe=["src","alt"],be={key:0,class:"absolute inset-0 bg-black-300 rounded-md animate-pulse"},ge={key:1,class:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-20 rounded-md"},ye=["src"],ke=["title"],xe=C({__name:"ItemVideo",props:{name:{},video:{},thumbnail:{}},emits:["show"],setup(e){const i=p(!1),o=p(!1);function u(){i.value=!0}return(t,a)=>(s(),n("div",he,[i.value?g("",!0):(s(),n("div",{key:0,class:"relative w-full aspect-video rounded-md cursor-pointer bg-gray-800",onClick:u},[r("img",{src:e.thumbnail,alt:e.name,class:"w-full h-full object-cover rounded-md",loading:"lazy",onLoad:a[0]||(a[0]=m=>o.value=!0),onError:a[1]||(a[1]=m=>o.value=!0)},null,40,pe),o.value?g("",!0):(s(),n("div",be)),o.value?(s(),n("div",ge,[...a[2]||(a[2]=[r("div",{class:"w-16 h-16 bg-white bg-opacity-90 rounded-full flex items-center justify-center hover:bg-opacity-100 transition-all"},[r("svg",{class:"w-8 h-8 text-black ml-1",fill:"currentColor",viewBox:"0 0 24 24"},[r("path",{d:"M8 5v14l11-7z"})])],-1)])])):g("",!0)])),i.value?(s(),n("video",{key:1,class:"object-cover w-full h-full rounded-md",src:e.video,autoplay:"",muted:"",playsinline:"",controls:""},null,8,ye)):g("",!0),r("div",null,[r("p",{class:"text-sm truncate px-0.5 mt-1.5 text-white",title:e.name},w(e.name),9,ke)])]))}}),we={class:"relative flex-1 w-full"},$e={key:3,class:"py-10"},Ie=C({__name:"ItemsList",props:{items:{},itemsCount:{},loading:{type:Boolean},search:{},hasFilters:{type:Boolean,default:!1},hasSelectedFilters:{type:Boolean,default:!1},filters:{},filtersValues:{},isVideo:{type:Boolean,default:!1},hasSearch:{type:Boolean,default:!0}},emits:["set-query","select","load-more","open-filters","remove-filter"],setup(e,{emit:i}){const o=i,u=p(null),{y:t}=H(u),a=p(!1);function m(c){a.value=c,c===!0&&o("load-more")}return(c,d)=>(s(),n("div",we,[e.hasSearch?(s(),q(ve,{key:0,query:e.search,"scrolled-down":x(t)>40,total:e.itemsCount,loading:e.loading,"has-filters":e.hasFilters,"has-selected-filters":e.hasSelectedFilters,filters:e.filters,"filters-values":e.filtersValues,onInput:d[0]||(d[0]=l=>c.$emit("set-query",l)),onOpenFilters:d[1]||(d[1]=l=>c.$emit("open-filters")),onRemoveFilter:d[2]||(d[2]=l=>c.$emit("remove-filter",l))},null,8,["query","scrolled-down","total","loading","has-filters","has-selected-filters","filters","filters-values"])):g("",!0),r("div",{ref_key:"el",ref:u,class:F(["grid w-full gap-3 p-4 px-5 pb-32 mx-auto overflow-y-scroll h-[calc(100vh-69px)]",{"grid-cols-1 lg:grid-cols-2 xl:grid-cols-3":e.isVideo,"items-grid-small md:items-grid":!e.isVideo}])},[e.isVideo?(s(!0),n($,{key:1},V(e.items,l=>(s(),q(xe,{key:l.id,name:l.name,video:l.video,thumbnail:l.thumbnail},null,8,["name","video","thumbnail"]))),128)):(s(!0),n($,{key:0},V(e.items,l=>(s(),q(X,{id:l.id,key:l.id,name:l.name,image:l.image,souvenir:l?.souvenir??!1,stattrak:l?.stattrak??!1,rare:l?.rare??!1,genuine:l?.genuine??!1,"market-hash-name":l.market_hash_name,onShow:b=>c.$emit("select",l.id)},null,8,["id","name","image","souvenir","stattrak","rare","genuine","market-hash-name","onShow"]))),128)),e.loading?(s(),q(Y,{key:2})):g("",!0),e.loading?g("",!0):L((s(),n("div",$e,null,512)),[[x(J),m]])],2)]))}}),Ve=["value","checked","onChange"],Ce=C({__name:"MultiSelectFilter",props:{options:{},values:{}},emits:["update:values"],setup(e,{emit:i}){const o=e,u=i,t=p(""),a=W(()=>o.options.filter(d=>d.name.toLocaleLowerCase().includes(t.value.toLocaleLowerCase()))),m=d=>{const l=o.values,b=l.indexOf(d);b===-1?l.push(d):l.splice(b,1),u("update:values",l)},c=d=>o.values.includes(d);return(d,l)=>(s(),n("div",null,[L(r("input",{"onUpdate:modelValue":l[0]||(l[0]=b=>t.value=b),class:"w-full h-full py-3 text-white rounded-md outline-none bg-black-300 border-2 border-black-300 focus:outline-none mb-4 sm:text-sm focus:ring-2 focus:ring-[#ff5e65] focus:border-transparent",type:"text",placeholder:"Search to filter..."},null,512),[[O,t.value]]),(s(!0),n($,null,V(a.value,b=>(s(),n("label",{key:b.id,class:"flex items-center gap-2 p-2 text-gray-300 rounded-md cursor-pointer hover:bg-black-300"},[r("input",{type:"checkbox",class:"w-4 h-4 text-[#ff5e65] border-gray-300 rounded focus:ring-[#ff5e65]",value:b.id,checked:c(b.id),onChange:y=>m(b.id)},null,40,Ve),S(" "+w(b.name),1)]))),128))]))}}),qe={key:0},Fe=C({__name:"FiltersPanelControl",props:{prop:{},name:{},type:{},options:{},values:{}},emits:["close","update:values"],setup(e){return(i,o)=>e.type==="multi-select"?(s(),n("div",qe,[k(Ce,{options:e.options,values:e.values,"onUpdate:values":o[0]||(o[0]=u=>i.$emit("update:values",{prop:e.prop,value:u}))},null,8,["options","values"])])):g("",!0)}}),Se={class:"h-dvh md:border-l-2 border-black-300 md:w-80 flex-shrink-0 xl:w-[30rem] flex flex-col absolute inset-0 md:relative bg-black-400 z-50"},Be={class:"flex items-center w-full h-[69px] border-b-2 border-black-300 px-4 sticky top-0 text-black-100"},je={class:"h-[calc(100vh-69px)] py-4 pt-0 overflow-x-hidden"},Le=["onClick"],Ae={class:"text-sm font-normal text-black-100"},Me=C({__name:"FiltersPanel",props:{filters:{},filtersValues:{}},emits:["close","set-filters","remove-filters"],setup(e){const i=p({});return(o,u)=>(s(),n("div",Se,[r("div",Be,[r("button",{class:"ml-auto disabled:cursor-wait",onClick:u[0]||(u[0]=t=>o.$emit("close"))},[k(x(z),{class:"w-6 h-6 text-white"})])]),r("div",je,[Object.keys(e.filtersValues).length>0?(s(),n("button",{key:0,type:"button",class:"w-full py-2 mb-2 font-semibold text-red-800 border-y-2 border-red-800/20 bg-red-900/20 hover:bg-red-900/30",onClick:u[1]||(u[1]=t=>o.$emit("remove-filters"))}," Remove all selected filters ")):g("",!0),r("div",null,[(s(!0),n($,null,V(e.filters,t=>(s(),n("div",{key:t.prop},[r("button",{class:"sticky top-0 flex items-center justify-between w-full p-4 font-semibold text-gray-100 border-b-2 border-black-300 bg-black-400",onClick:a=>i.value[t.prop]=!i.value[t.prop]},[r("div",null,[S(w(t.name)+" ",1),r("span",Ae,"("+w(e.filtersValues[t.prop]?.length?`${e.filtersValues[t.prop].length}/${t.options.length}`:t.options.length)+")",1)]),k(x(_),{class:F(["w-6 h-6 duration-300 text-black-200",{"rotate-180":i.value[t.prop]}])},null,8,["class"])],8,Le),i.value[t.prop]?(s(),n("div",{key:0,class:F(["p-4",{"border-b-2 border-black-300":i.value}])},[k(Fe,{prop:t.prop,name:t.name,type:t.type,options:t.options,values:e.filtersValues[t.prop]??[],"onUpdate:values":u[2]||(u[2]=a=>o.$emit("set-filters",a))},null,8,["prop","name","type","options","values"])],2)):g("",!0)]))),128))])])]))}});export{Ie as _,Me as a,ze as c};
