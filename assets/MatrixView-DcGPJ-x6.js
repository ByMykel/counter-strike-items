var Te=Object.defineProperty;var Re=(n,s,e)=>s in n?Te(n,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[s]=e;var le=(n,s,e)=>Re(n,typeof s!="symbol"?s+"":s,e);import{d as j,z as r,K as H,B as m,y as Q,V as Ie,P as Xe,A as l,F as D,J as R,H as Ee,I as O,G as S,a2 as U,L as b,o as _e,n as J,f as oe,b as Fe,O as Le,r as p,c as _,D as Ve,E as Ae}from"./vue-vendor-BFlCEXhy.js";import{b as Ke}from"./vueuse-C5go1KEJ.js";import{S as ze}from"./SkinService-aNWuqlSx.js";import{S as He}from"./StickersService-C2WUUrjR.js";import{_ as Oe,d as We,b as Be}from"./index-DhxEeTeD.js";import{u as qe}from"./useTitle-BGKk_3Sv.js";import"./utils-vendor-DMCOh9hm.js";import"./search-Dw8P0qyA.js";class Ne{constructor(){le(this,"skinService",new ze);le(this,"stickersService",new He)}async loadKnives(){const s=new Set;return this.skinService.query({search:"",filters:{category:["sfui_invpanel_filter_melee"]}}).then(e=>(e.items=e.items.filter(a=>s.has(a.skin_id)?!1:(s.add(a.skin_id),!0)),e.items))}async loadTeamStickers(){return this.stickersService.query({search:"",filters:{}}).then(s=>s.items.filter(e=>e.tournament&&e.team&&!e.player))}async loadPlayerStickers(){return this.stickersService.query({search:"",filters:{}}).then(s=>s.items.filter(e=>e.tournament&&e.player))}async loadAllTabsData(){const[s,e,a]=await Promise.all([this.loadKnives(),this.loadTeamStickers(),this.loadPlayerStickers()]),d=[],c=this.processKnives(s);d.push({id:"knives",name:"Knives",showCrates:!0,showOnlyFirstItem:!1,...c});const x=this.processTeamStickers(e);d.push({id:"team-stickers",name:"Team Stickers",showCrates:!1,showOnlyFirstItem:!0,...x});const v=this.processPlayerStickers(a);return d.push({id:"player-stickers",name:"Player Stickers",showCrates:!1,showOnlyFirstItem:!0,...v}),d}processMatrix(s,e){const a=new Set,d=new Map;for(const i of s){const h=e.getColumnValue(i);a.add(h);const f=e.getRowKey(i);d.has(f)||d.set(f,e.getRowItem(i))}const c=Array.from(a).sort(),x=new Map;for(const i of s){const h=e.getColumnValue(i),T=`${e.getRowKey(i)}|${h}`;x.has(T)||x.set(T,{items:[],...e.includeCrates?{crates:[]}:{}});const w=x.get(T);if(w.items.push({id:i.id,name:i.name,image:i.image}),e.includeCrates){const $=e.includeCrates(i);$&&w.crates.push(...$)}}const v=new Map;for(const i of s){const h=e.getRowKey(i),f=e.getColumnValue(i);v.has(h)||v.set(h,new Set),v.get(h).add(f)}const M=c.length,C=new Map,I=Array.from(d.entries()).map(([i,h])=>{const f=String(e.getRowDisplay(h,i)||""),T=v.get(i)?.size||0,w=e.showCountInDisplay?`${f} (${T}/${M})`:f;return C.set(i,w),{key:i,display:f,count:T}}).sort((i,h)=>e.customSort?e.customSort(i,h):h.count!==i.count?h.count-i.count:String(i.display).localeCompare(String(h.display))).map(i=>i.key);return{columns:c,rows:I,rowDisplayMap:C,matrixMap:x}}processTeamStickers(s){return this.processMatrix(s,{getColumnValue:e=>e.tournament.name,getRowKey:e=>e.team.name,getRowDisplay:e=>e.team.name,getRowItem:e=>e,showCountInDisplay:!0})}processPlayerStickers(s){return this.processMatrix(s,{getColumnValue:e=>e.tournament.name,getRowKey:e=>e.player.name,getRowDisplay:e=>e.player.name,getRowItem:e=>e,showCountInDisplay:!0})}processKnives(s){return this.processMatrix(s,{getColumnValue:e=>e.weapon?.name||"Unknown",getRowKey:e=>{const a=e.pattern?.name||"Vanilla";return e.phase?`${a} (${e.phase})`:a},getRowDisplay:e=>{const a=e.pattern?.name||"Vanilla";return e.phase?`${a} (${e.phase})`:a},getRowItem:e=>e,includeCrates:e=>e.crates,customSort:(e,a)=>e.key==="Vanilla"?-1:a.key==="Vanilla"?1:a.count!==e.count?a.count-e.count:e.display.localeCompare(a.display)})}}const Pe={class:"flex items-center justify-between border-black-300 border-b-2 h-[69px] px-4"},Ue={class:"flex items-center gap-2"},je=j({__name:"MatrixHeader",setup(n){return(s,e)=>(l(),r("div",Pe,[H(Oe),m("div",Ue,[H(Q(Ie),{to:"/",class:"flex items-center gap-2 px-3 py-2 rounded-md text-black-100 hover:bg-black-300 hover:text-white transition-colors"},{default:Xe(()=>[H(Q(We),{class:"w-5 h-5"}),e[0]||(e[0]=m("span",{class:"text-sm font-medium"},"Back to Home",-1))]),_:1})])]))}}),Ye={class:"inline-flex px-4 py-2 p-1 gap-0 w-full border-b-2 border-black-300"},Ge=["onClick"],Je=j({__name:"MatrixTabs",props:{tabs:{},selectedTabId:{}},emits:["select-tab"],setup(n){return(s,e)=>(l(),r("div",Ye,[(l(!0),r(D,null,R(n.tabs,(a,d)=>(l(),r("button",{key:a.id,class:Ee(["px-4 py-2 text-sm font-medium transition-all",n.selectedTabId===a.id?"bg-black-300 text-white rounded shadow-sm":d===0?"bg-black-400 text-black-100 rounded-l":d===n.tabs.length-1?"bg-black-400 text-black-100 rounded-r":"bg-black-400 text-black-100"]),onClick:c=>s.$emit("select-tab",a.id)},O(a.name),11,Ge))),128))]))}}),Qe={key:0,class:"flex flex-col gap-2 items-center justify-center h-full"},Ze={class:"flex flex-wrap gap-1 justify-center"},et=["src","alt"],tt={class:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-black-500 text-white text-xs rounded opacity-0 group-hover:opacity-100 pointer-events-none whitespace-nowrap z-30 max-w-[200px] text-center"},at=["onClick"],nt=["src","alt"],st={class:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-black-500 text-white text-xs rounded opacity-0 group-hover:opacity-100 pointer-events-none whitespace-nowrap z-30 max-w-[200px] text-center"},lt={key:0,class:"flex flex-wrap gap-1 justify-center"},ot=["onClick"],rt=["src","alt"],it={class:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-black-500 text-white text-xs rounded opacity-0 group-hover:opacity-100 pointer-events-none whitespace-nowrap z-30"},ct={key:1,class:"text-black-300 text-xs"},ut=j({__name:"MatrixCell",props:{cellData:{},row:{},column:{},showOnlyFirstItem:{type:Boolean},showCrates:{type:Boolean}},emits:["select-item","select-crate"],setup(n){function s(a){return a?.includes("cdn.steamstatic")||a?.includes("raw.githubusercontent")?a:a+"/62fx62fdpx2x"}function e(a){return a?.includes("cdn.steamstatic")||a?.includes("raw.githubusercontent")?a:a+"/32fx32fdpx2x"}return(a,d)=>n.cellData?(l(),r("div",Qe,[m("div",Ze,[n.showOnlyFirstItem?(l(),r(D,{key:0},[n.cellData.items.length>0?(l(),r("button",{key:`${n.row}-${n.column}-${n.cellData.items[0].id}`,class:"group relative flex flex-col items-center",onClick:d[1]||(d[1]=c=>a.$emit("select-item",n.cellData.items[0].id))},[m("img",{src:s(n.cellData.items[0].image),alt:n.cellData.items[0].name,draggable:"false",class:"w-24 h-24 object-contain rounded hover:opacity-80 transition-opacity select-none",onDragstart:d[0]||(d[0]=U(()=>{},["prevent"]))},null,40,et),m("div",tt,O(n.cellData.items[0].name),1)])):S("",!0)],64)):(l(!0),r(D,{key:1},R(n.cellData.items,c=>(l(),r("button",{key:`${n.row}-${n.column}-${c.id}`,class:"group relative flex flex-col items-center",onClick:x=>a.$emit("select-item",c.id)},[m("img",{src:s(c.image),alt:c.name,draggable:"false",class:"w-16 h-16 object-contain rounded hover:opacity-80 transition-opacity select-none",onDragstart:d[2]||(d[2]=U(()=>{},["prevent"]))},null,40,nt),m("div",st,O(c.name),1)],8,at))),128))]),n.showCrates&&n.cellData.crates?(l(),r("div",lt,[(l(!0),r(D,null,R(n.cellData.crates,c=>(l(),r("button",{key:`${n.row}-${n.column}-crate-${c.id}`,class:"group relative",onClick:U(x=>a.$emit("select-crate",c.id),["stop"])},[m("img",{src:e(c.image),alt:c.name,draggable:"false",class:"w-8 h-8 object-contain rounded hover:opacity-80 transition-opacity select-none",onDragstart:d[3]||(d[3]=U(()=>{},["prevent"]))},null,40,rt),m("div",it,O(c.name),1)],8,ot))),128))])):S("",!0)])):(l(),r("span",ct,"â€”"))}}),mt={class:"sticky top-0 z-10 bg-black-400",style:{"box-shadow":"0 2px 0 #212121"}},dt={class:"text-xs text-black-100 line-clamp-3"},ce=180,vt=j({__name:"MatrixTableHeader",props:{visibleColumns:{},visibleColStart:{},visibleColEnd:{},totalColumns:{},translateX:{},isDesktop:{type:Boolean}},setup(n){return(s,e)=>(l(),r("thead",mt,[m("tr",null,[m("th",{class:"bg-black-400 border-r-2 border-black-300 px-3 py-2 w-[250px] h-[60px] lg:z-[15] lg:relative",style:b({transform:n.isDesktop?`translateX(${-n.translateX}px)`:void 0})},null,4),n.visibleColStart>0?(l(),r("th",{key:0,style:b({width:`${n.visibleColStart*ce}px`})},null,4)):S("",!0),(l(!0),r(D,null,R(n.visibleColumns,a=>(l(),r("th",{key:a,class:"border-r border-black-300 px-3 py-2 w-[180px] h-[60px] text-center align-middle overflow-hidden"},[m("span",dt,O(a),1)]))),128)),n.visibleColEnd<n.totalColumns-1?(l(),r("th",{key:1,style:b({width:`${(n.totalColumns-n.visibleColEnd-1)*ce}px`})},null,4)):S("",!0)])]))}}),ht={class:"flex flex-col flex-1 h-full min-w-0"},pt={class:"flex-shrink-0"},ft={key:0,class:"flex-1 flex items-center justify-center"},yt={class:"border-separate",style:{"border-spacing":"0"}},xt={class:"text-sm text-white break-words"},z=120,F=180,P=250,ue=3,me=2,Tt=j({__name:"MatrixView",setup(n){const s=Ke("(min-width: 1024px)"),e=Be(),a=Ve(),d=Ae(),c=p(),x=p(!0),v=p(0),M=p(!1),C=p(0),Z=p(0),I=p(0),i=p(!1),h=p(!1),f=p([]);function T(){const t=a.query.tab;return t&&f.value.some(u=>u.id===t)?t:f.value[0]?.id||""}const w=p(""),$=_(()=>f.value.find(t=>t.id===w.value)),g=_(()=>$.value?.columns||[]),L=_(()=>$.value?.rows||[]),de=_(()=>$.value?.rowDisplayMap||new Map),ve=_(()=>$.value?.matrixMap||new Map),he=new Ne,pe=p(0),Y=p(0),G=p(0),W=p(0),B=p(0),fe=_(()=>L.value.slice(Y.value,G.value+1)),re=_(()=>g.value.slice(W.value,B.value+1));function V(){if(!c.value||L.value.length===0||g.value.length===0)return;const t=c.value,u=t.clientHeight,o=t.clientWidth,k=t.scrollTop,X=Math.max(0,Math.floor(k/z)-ue),E=Math.min(L.value.length-1,Math.ceil((k+u)/z)+ue),K=-v.value,N=K+o,Se=Math.max(0,Math.floor((K-P)/F)-me),De=Math.min(g.value.length-1,Math.ceil((N-P)/F)+me);Y.value=X,G.value=E,W.value=Se,B.value=De}function ye(){c.value&&(pe.value=c.value.scrollTop,V())}async function xe(){x.value=!0;try{f.value=await he.loadAllTabsData(),w.value===""&&(w.value=T()),J(()=>{V()})}catch(t){console.error("Error loading special items:",t)}finally{x.value=!1}}function be(t,u){const o=`${t}|${u}`;return ve.value.get(o)||null}function we(t){return de.value.get(t)||t}function ge(t){e.getItemDetails(t)}function ke(t){e.getItemDetails(t)}function Me(t){if(t.button!==0)return;const o=t.target.closest("button");o&&o.addEventListener("click",ie,{once:!0,capture:!0}),M.value=!0,i.value=!1,C.value=t.clientX,I.value=v.value,t.preventDefault(),document.addEventListener("mousemove",ee),document.addEventListener("mouseup",te)}function ie(t){i.value&&(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation())}let y=null;function q(){if(!c.value||g.value.length===0)return 0;const t=P+g.value.length*F,u=c.value.clientWidth;if(t<=u)return 0;const o=-(t-u);return Math.round(o)}function ee(t){if(!M.value)return;Math.abs(t.clientX-C.value)>5&&(i.value=!0),y!==null&&cancelAnimationFrame(y),y=requestAnimationFrame(()=>{const o=t.clientX-C.value,k=0,X=q(),E=Math.max(Math.min(I.value+o,k),X);v.value=Math.round(E),y=null}),t.preventDefault()}function te(){M.value=!1,document.removeEventListener("mousemove",ee),document.removeEventListener("mouseup",te)}function Ce(t){if(t.touches.length!==1)return;const o=t.target.closest("button");o&&o.addEventListener("click",ie,{once:!0,capture:!0}),M.value=!0,i.value=!1,h.value=!1,C.value=t.touches[0].clientX,Z.value=t.touches[0].clientY,I.value=v.value,document.addEventListener("touchmove",ae,{passive:!1}),document.addEventListener("touchend",ne)}function ae(t){if(!M.value||t.touches.length!==1)return;const u=Math.abs(t.touches[0].clientX-C.value),o=Math.abs(t.touches[0].clientY-Z.value);if(Math.sqrt(u*u+o*o)>5&&(i.value=!0),u>10&&u>o)h.value||(h.value=!0),y!==null&&cancelAnimationFrame(y),y=requestAnimationFrame(()=>{const X=t.touches[0].clientX-C.value,E=0,K=q(),N=Math.max(Math.min(I.value+X,E),K);v.value=Math.round(N),y=null}),t.preventDefault();else if(h.value)y!==null&&cancelAnimationFrame(y),y=requestAnimationFrame(()=>{const X=t.touches[0].clientX-C.value,E=0,K=q(),N=Math.max(Math.min(I.value+X,E),K);v.value=Math.round(N),y=null}),t.preventDefault();else return}function ne(){M.value=!1,h.value=!1,document.removeEventListener("touchmove",ae),document.removeEventListener("touchend",ne)}let A=null;const $e=t=>{t.preventDefault(),t.stopPropagation(),A!==null&&cancelAnimationFrame(A),A=requestAnimationFrame(()=>{const o=q(),k=Math.max(Math.min(v.value-t.deltaX,0),o);v.value=Math.round(k),A=null})};function se(){const u=q(),o=Math.max(Math.min(v.value,0),u);v.value=Math.round(o)}return _e(async()=>{await xe(),await J(),se(),V()}),oe([g,L],async()=>{await J(),se(),V()}),oe(v,()=>{V()}),oe(w,t=>{d.replace({query:{...a.query,tab:t}}),v.value=0,c.value&&(c.value.scrollTop=0),J(()=>{se(),V()})}),Fe(()=>{document.removeEventListener("mousemove",ee),document.removeEventListener("mouseup",te),document.removeEventListener("touchmove",ae),document.removeEventListener("touchend",ne),y!==null&&cancelAnimationFrame(y),A!==null&&cancelAnimationFrame(A)}),qe("Matrix - Counter-Strike items"),(t,u)=>(l(),r("div",ht,[m("div",pt,[H(je),x.value?S("",!0):(l(),Le(Je,{key:0,tabs:f.value,"selected-tab-id":w.value,onSelectTab:u[0]||(u[0]=o=>w.value=o)},null,8,["tabs","selected-tab-id"]))]),x.value?(l(),r("div",ft,[...u[1]||(u[1]=[m("svg",{class:"size-8 animate-spin text-white/10",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[m("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),m("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)])])):(l(),r("div",{key:1,ref_key:"containerRef",ref:c,class:"flex-1 overflow-y-scroll overflow-x-hidden relative min-w-0 max-w-full",style:{height:"0"},onWheel:U($e,["shift"]),onMousedown:Me,onTouchstart:Ce,onScroll:ye},[m("div",{class:"select-none",style:b({minWidth:"max-content",transform:`translateX(${v.value}px)`,transition:M.value?"none":"transform 0.1s ease-out",cursor:M.value?"grabbing":"grab"})},[m("table",yt,[H(vt,{"visible-columns":re.value,"visible-col-start":W.value,"visible-col-end":B.value,"total-columns":g.value.length,"translate-x":v.value,"is-desktop":Q(s)},null,8,["visible-columns","visible-col-start","visible-col-end","total-columns","translate-x","is-desktop"]),m("tbody",null,[Y.value>0?(l(),r("tr",{key:0,style:b({height:`${Y.value*z}px`})},[m("td",{style:b({width:`${P}px`})},null,4),(l(!0),r(D,null,R(g.value,o=>(l(),r("td",{key:`spacer-${o}`,style:b({width:`${F}px`})},null,4))),128))],4)):S("",!0),(l(!0),r(D,null,R(fe.value,o=>(l(),r("tr",{key:o,class:"hover:bg-black-300/20 border-b border-black-300/30"},[m("td",{class:"bg-black-400 border-r-2 border-b border-black-300 px-3 py-2 w-[250px] h-[120px] align-middle lg:relative lg:z-[5]",style:b({transform:Q(s)?`translateX(${-v.value}px)`:void 0})},[m("span",xt,O(we(o)),1)],4),W.value>0?(l(),r("td",{key:0,style:b({width:`${W.value*F}px`,height:`${z}px`})},null,4)):S("",!0),(l(!0),r(D,null,R(re.value,k=>(l(),r("td",{key:`${o}-${k}`,class:"border-r border-black-300/50 px-2 py-2 w-[180px] h-[120px] align-middle text-center"},[H(ut,{"cell-data":be(o,k),row:o,column:k,"show-only-first-item":$.value?.showOnlyFirstItem,"show-crates":$.value?.showCrates,onSelectItem:ke,onSelectCrate:ge},null,8,["cell-data","row","column","show-only-first-item","show-crates"])]))),128)),B.value<g.value.length-1?(l(),r("td",{key:1,style:b({width:`${(g.value.length-B.value-1)*F}px`,height:`${z}px`})},null,4)):S("",!0)]))),128)),G.value<L.value.length-1?(l(),r("tr",{key:1,style:b({height:`${(L.value.length-G.value-1)*z}px`})},[m("td",{style:b({width:`${P}px`})},null,4),(l(!0),r(D,null,R(g.value,o=>(l(),r("td",{key:`spacer-bottom-${o}`,style:b({width:`${F}px`})},null,4))),128))],4)):S("",!0)])])],4)],544))]))}});export{Tt as default};
